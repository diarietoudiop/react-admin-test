{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\nimport { useState, useCallback } from 'react';\nimport { useDelete } from '../../dataProvider';\nimport { useUnselect } from '../../controller';\nimport { useRedirect } from '../../routing';\nimport { useNotify } from '../../notification';\nimport { useResourceContext } from '../../core';\nimport { useTranslate } from '../../i18n';\n/**\n * Prepare a set of callbacks for a delete button guarded by confirmation dialog\n *\n * @example\n *\n * const DeleteButton = ({\n *     resource,\n *     record,\n *     redirect,\n *     onClick,\n *     ...rest\n * }) => {\n *     const {\n *         open,\n *         isPending,\n *         handleDialogOpen,\n *         handleDialogClose,\n *         handleDelete,\n *     } = useDeleteWithConfirmController({\n *         resource,\n *         record,\n *         redirect,\n *         onClick,\n *     });\n *\n *     return (\n *         <Fragment>\n *             <Button\n *                 onClick={handleDialogOpen}\n *                 label=\"ra.action.delete\"\n *                 {...rest}\n *             >\n *                 {icon}\n *             </Button>\n *             <Confirm\n *                 isOpen={open}\n *                 loading={isPending}\n *                 title=\"ra.message.delete_title\"\n *                 content=\"ra.message.delete_content\"\n *                 translateOptions={{\n *                     name: resource,\n *                     id: record.id,\n *                 }}\n *                 onConfirm={handleDelete}\n *                 onClose={handleDialogClose}\n *             />\n *         </Fragment>\n *     );\n * };\n */\nvar useDeleteWithConfirmController = function (props) {\n  var record = props.record,\n    _a = props.redirect,\n    redirectTo = _a === void 0 ? 'list' : _a,\n    mutationMode = props.mutationMode,\n    onClick = props.onClick,\n    _b = props.mutationOptions,\n    mutationOptions = _b === void 0 ? {} : _b,\n    successMessage = props.successMessage;\n  var mutationMeta = mutationOptions.meta,\n    otherMutationOptions = __rest(mutationOptions, [\"meta\"]);\n  var resource = useResourceContext(props);\n  var _c = useState(false),\n    open = _c[0],\n    setOpen = _c[1];\n  var notify = useNotify();\n  var unselect = useUnselect(resource);\n  var redirect = useRedirect();\n  var translate = useTranslate();\n  var _d = useDelete(resource, undefined, {\n      onSuccess: function () {\n        setOpen(false);\n        notify(successMessage !== null && successMessage !== void 0 ? successMessage : \"resources.\".concat(resource, \".notifications.deleted\"), {\n          type: 'info',\n          messageArgs: {\n            smart_count: 1,\n            _: translate('ra.notification.deleted', {\n              smart_count: 1\n            })\n          },\n          undoable: mutationMode === 'undoable'\n        });\n        record && unselect([record.id]);\n        redirect(redirectTo, resource);\n      },\n      onError: function (error) {\n        setOpen(false);\n        notify(typeof error === 'string' ? error : (error === null || error === void 0 ? void 0 : error.message) || 'ra.notification.http_error', {\n          type: 'error',\n          messageArgs: {\n            _: typeof error === 'string' ? error : (error === null || error === void 0 ? void 0 : error.message) ? error.message : undefined\n          }\n        });\n      }\n    }),\n    deleteOne = _d[0],\n    isPending = _d[1].isPending;\n  var handleDialogOpen = function (e) {\n    setOpen(true);\n    e.stopPropagation();\n  };\n  var handleDialogClose = function (e) {\n    setOpen(false);\n    e.stopPropagation();\n  };\n  var handleDelete = useCallback(function (event) {\n    event.stopPropagation();\n    if (!record) {\n      throw new Error('The record cannot be deleted because no record has been passed');\n    }\n    deleteOne(resource, {\n      id: record.id,\n      previousData: record,\n      meta: mutationMeta\n    }, __assign({\n      mutationMode: mutationMode\n    }, otherMutationOptions));\n    if (typeof onClick === 'function') {\n      onClick(event);\n    }\n  }, [deleteOne, mutationMeta, mutationMode, otherMutationOptions, onClick, record, resource]);\n  return {\n    open: open,\n    isPending: isPending,\n    isLoading: isPending,\n    handleDialogOpen: handleDialogOpen,\n    handleDialogClose: handleDialogClose,\n    handleDelete: handleDelete\n  };\n};\nexport default useDeleteWithConfirmController;","map":{"version":3,"names":["useState","useCallback","useDelete","useUnselect","useRedirect","useNotify","useResourceContext","useTranslate","useDeleteWithConfirmController","props","record","_a","redirect","redirectTo","mutationMode","onClick","_b","mutationOptions","successMessage","mutationMeta","meta","otherMutationOptions","__rest","resource","_c","open","setOpen","notify","unselect","translate","_d","undefined","onSuccess","concat","type","messageArgs","smart_count","_","undoable","id","onError","error","message","deleteOne","isPending","handleDialogOpen","e","stopPropagation","handleDialogClose","handleDelete","event","Error","previousData","__assign","isLoading"],"sources":["/home/diarietou/Bureau/afterSA/test/testfront/react-admin-test/node_modules/ra-core/src/controller/button/useDeleteWithConfirmController.tsx"],"sourcesContent":["import {\n    useState,\n    useCallback,\n    ReactEventHandler,\n    SyntheticEvent,\n} from 'react';\nimport { UseMutationOptions } from '@tanstack/react-query';\n\nimport { useDelete } from '../../dataProvider';\nimport { useUnselect } from '../../controller';\nimport { useRedirect, RedirectionSideEffect } from '../../routing';\nimport { useNotify } from '../../notification';\nimport { RaRecord, MutationMode, DeleteParams } from '../../types';\nimport { useResourceContext } from '../../core';\nimport { useTranslate } from '../../i18n';\n\n/**\n * Prepare a set of callbacks for a delete button guarded by confirmation dialog\n *\n * @example\n *\n * const DeleteButton = ({\n *     resource,\n *     record,\n *     redirect,\n *     onClick,\n *     ...rest\n * }) => {\n *     const {\n *         open,\n *         isPending,\n *         handleDialogOpen,\n *         handleDialogClose,\n *         handleDelete,\n *     } = useDeleteWithConfirmController({\n *         resource,\n *         record,\n *         redirect,\n *         onClick,\n *     });\n *\n *     return (\n *         <Fragment>\n *             <Button\n *                 onClick={handleDialogOpen}\n *                 label=\"ra.action.delete\"\n *                 {...rest}\n *             >\n *                 {icon}\n *             </Button>\n *             <Confirm\n *                 isOpen={open}\n *                 loading={isPending}\n *                 title=\"ra.message.delete_title\"\n *                 content=\"ra.message.delete_content\"\n *                 translateOptions={{\n *                     name: resource,\n *                     id: record.id,\n *                 }}\n *                 onConfirm={handleDelete}\n *                 onClose={handleDialogClose}\n *             />\n *         </Fragment>\n *     );\n * };\n */\nconst useDeleteWithConfirmController = <\n    RecordType extends RaRecord = any,\n    ErrorType = Error,\n>(\n    props: UseDeleteWithConfirmControllerParams<RecordType, ErrorType>\n): UseDeleteWithConfirmControllerReturn => {\n    const {\n        record,\n        redirect: redirectTo = 'list',\n        mutationMode,\n        onClick,\n        mutationOptions = {},\n        successMessage,\n    } = props;\n    const { meta: mutationMeta, ...otherMutationOptions } = mutationOptions;\n    const resource = useResourceContext(props);\n    const [open, setOpen] = useState(false);\n    const notify = useNotify();\n    const unselect = useUnselect(resource);\n    const redirect = useRedirect();\n    const translate = useTranslate();\n\n    const [deleteOne, { isPending }] = useDelete<RecordType, ErrorType>(\n        resource,\n        undefined,\n        {\n            onSuccess: () => {\n                setOpen(false);\n                notify(\n                    successMessage ??\n                        `resources.${resource}.notifications.deleted`,\n                    {\n                        type: 'info',\n                        messageArgs: {\n                            smart_count: 1,\n                            _: translate('ra.notification.deleted', {\n                                smart_count: 1,\n                            }),\n                        },\n                        undoable: mutationMode === 'undoable',\n                    }\n                );\n                record && unselect([record.id]);\n                redirect(redirectTo, resource);\n            },\n            onError: error => {\n                setOpen(false);\n\n                notify(\n                    typeof error === 'string'\n                        ? error\n                        : (error as Error)?.message ||\n                              'ra.notification.http_error',\n                    {\n                        type: 'error',\n                        messageArgs: {\n                            _:\n                                typeof error === 'string'\n                                    ? error\n                                    : (error as Error)?.message\n                                      ? (error as Error).message\n                                      : undefined,\n                        },\n                    }\n                );\n            },\n        }\n    );\n\n    const handleDialogOpen = e => {\n        setOpen(true);\n        e.stopPropagation();\n    };\n\n    const handleDialogClose = e => {\n        setOpen(false);\n        e.stopPropagation();\n    };\n\n    const handleDelete = useCallback(\n        event => {\n            event.stopPropagation();\n            if (!record) {\n                throw new Error(\n                    'The record cannot be deleted because no record has been passed'\n                );\n            }\n            deleteOne(\n                resource,\n                {\n                    id: record.id,\n                    previousData: record,\n                    meta: mutationMeta,\n                },\n                {\n                    mutationMode,\n                    ...otherMutationOptions,\n                }\n            );\n            if (typeof onClick === 'function') {\n                onClick(event);\n            }\n        },\n        [\n            deleteOne,\n            mutationMeta,\n            mutationMode,\n            otherMutationOptions,\n            onClick,\n            record,\n            resource,\n        ]\n    );\n\n    return {\n        open,\n        isPending,\n        isLoading: isPending,\n        handleDialogOpen,\n        handleDialogClose,\n        handleDelete,\n    };\n};\n\nexport interface UseDeleteWithConfirmControllerParams<\n    RecordType extends RaRecord = any,\n    MutationOptionsError = unknown,\n> {\n    mutationMode?: MutationMode;\n    record?: RecordType;\n    redirect?: RedirectionSideEffect;\n    resource?: string;\n    onClick?: ReactEventHandler<any>;\n    mutationOptions?: UseMutationOptions<\n        RecordType,\n        MutationOptionsError,\n        DeleteParams<RecordType>\n    >;\n    successMessage?: string;\n}\n\nexport interface UseDeleteWithConfirmControllerReturn {\n    open: boolean;\n    isLoading: boolean;\n    isPending: boolean;\n    handleDialogOpen: (e: SyntheticEvent) => void;\n    handleDialogClose: (e: SyntheticEvent) => void;\n    handleDelete: ReactEventHandler<any>;\n}\n\nexport default useDeleteWithConfirmController;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}